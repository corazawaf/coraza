name: block
description: |
  Performs the disruptive action defined by the previous SecDefaultAction.
actiongroup: Disruptive
version: 0.1
experimental: true
data: |
  This action is essentially a placeholder that is intended to be used by rule writers to request a blocking action, but without specifying how the blocking is to be done. The idea is that such decisions are best left to rule users, as well as to allow users, to override blocking if they so desire. In future versions of ModSecurity, more control and functionality will be added to define "how" to block.

  Examples:
  ```
  # Specify how blocking is to be done 
  SecDefaultAction phase:2,deny,id:101,status:403,log,auditlog

  # Detect attacks where we want to block 
  SecRule ARGS attack1 phase:2,block,id:102

  # Detect attacks where we want only to warn 
  SecRule ARGS attack2 phase:2,pass,id:103
  ```

  It is possible to use the SecRuleUpdateActionById directive to override how a rule handles blocking. This is useful in three cases:

  1. If a rule has blocking hard-coded, and you want it to use the policy you determine
  2. If a rule was written to block, but you want it to only warn
  3. If a rule was written to only warn, but you want it to block
  
  The following example demonstrates the first case, in which the hard-coded block is removed in favor of the user-controllable block:

  ```
  # Specify how blocking is to be done 
  SecDefaultAction phase:2,deny,status:403,log,auditlog,id:104

  # Detect attacks and block 
  SecRule ARGS attack1 phase:2,id:1,deny

  # Change how rule ID 1 blocks 
  SecRuleUpdateActionById 1 block
  ```